db:
  image: postgres
  ports:
   - "5432:5432"
  
nginx:
  image: nginx
  volumes:
   - ./nginx.conf:/etc/nginx/conf.d/default.conf
   - ./ui/:/app
  volumes_from:
   - web
  ports:
   - "80:80"
  links:
   - web
  restart: always
  
web:
  build: .
  environment:
    - DEBUG=yes
    - HOST=0.0.0.0
    - SQLALCHEMY_DATABASE_URI=postgres://postgres@db
    - ENABLE_2FA=no
    - TOTP_DOMAIN=docker.dev
    - API_URL_PREFIX=/api
    - SESSION_TOKEN_MAX_AGE=300
  volumes:
    - .:/code
    - ./ui/:/app
  links:
    - db
